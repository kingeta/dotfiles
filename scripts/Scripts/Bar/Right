#! /usr/bin/bash
#
# this is my right bar
# 

# COLOURS

VOLUME="$(getcolour 1)"
COLOR1="$(getcolour 6)"
COLOR2="$(getcolour 5)"
COLOR3="$(getcolour 4)"
PAUSED="$(getcolour 8)"
BG="$(getcolour bg)"
FG="$(getcolour fg)"
DFG=$(getcolour darkened)

# INFORMATION

PlayingState() {
    echo -n "%{F#FF$DFG} "
    # show if it is playing or paused
    if [ -n "$(mpc | grep playing)" ]; then
        echo -n "[PLAYING]"
    else
        echo -n "[PAUSED]:"
    fi
    echo -n " %{F-}"
    # show what is playing
    if [ -z "$(mpc current)" ]; then
        echo -n "%{B#FF$COLOR2} Playlist Empty %{B-}"
    else
        if [ -z "$(mpc -f %artist% | sed -n '1p')" ]; then
            echo -n "%{B#FF$COLOR2} $(mpc current) %{B-}"
        else
            echo -n "%{B#FF$COLOR1} $(mpc -f %artist% | sed -n '1p') %{B-} "
            echo -n "%{B#FF$COLOR2} $(mpc -f %album% | sed -n '1p') %{B-} "
            echo -n "%{B#FF$COLOR3} $(mpc -f %title% | sed -n '1p') %{B-} "
        fi
    fi
}

Volume () {
    echo -n "%{F#FF$DFG} VOLUME: %{F-}"
    echo -n "%{B#FF$VOLUME} "
    i=0
    VOLUME=$(amixer get Master | grep 'Front Left' | egrep -o "[0-9]+%" | rev | cut -c 2- | rev )
    while [ $i -ne 100 ]; do
        if [ $VOLUME -gt $i ]; then
            echo -n "*"
        else
            echo -n " "
        fi
        i=$(( $i + 10))
    done
    echo -n " %{B-}"
}

# BAR

FONT="-*-gohufont-medium-r-*-*-14-*-*-*-*-*-*-*"
x="2560"
y="0"
w="1920"
h="30"
PARAMETERS="-f "$FONT" -g "$w"x"$h"+"$x"+"$y" -F #FF"$FG" -B #FF"$BG

while :; do echo "$(PlayingState)%{r}$(Volume)"; done | bar $PARAMETERS
